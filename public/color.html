<!DOCTYPE html>
<html>
    <head>
        <script src="/js/aframe.min.js"></script>
    </head>
    <body>
        <h1>Player 2</h1>
        
        <a-scene>
            <img id="BG" src= "assets/Sky.jpg">
            
            <!--camera stuff-->
            <a-entity position="8 3 8 " camera look-controls wasd-controls>
                <a-entity  
                cursor="fuse:true; fuseTimeout:500;"
                rayOrigin:mouse;
                position="0 0 -1"
                geometry="primitive:ring; radiusInner:0.015; radiusOuter:0.02;"
                material="shader:flat; color:white;" >
                </a-entity>

            <!-- <a-cylinder  position= "0 -1 -3"  color="crimson" rotation= " 97 0 0" height="10" radius="0.1"></a-cylinder> -->
            </a-entity>
            <!--lights-->
            <a-entity light="type:directional; castShadow:true; intensity:0.2; shadowBias:-0.00001; shadowMapWidth:1024; shadowMapHeight:1024;" position="-23 28 -50"></a-entity>
            <a-entity light="type:ambient; intensity:0.7; color:#FFF;"></a-entity> 
            <a-entity id="sky" 
            geometry = "primitive:sphere; radius: 500;"
            material="shader:flat; src:#BG; side:back; height:2048; width:2048" ></a-entity>
        </a-scene>
    
        <script src="/socket.io/socket.io.js"></script>
        <script>
            
            let socket = io();
    
            //default connect event
            socket.on('connect', function() {
                console.log("connected!");
            });
            // red torus 
            socket.on('red', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "red");
                fakeTarget.setAttribute('material', {color: "red"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:5, y:5, z:5});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);

            });

            // orange torus
            socket.on('orange', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "orange");
                fakeTarget.setAttribute('material', {color: "orange"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:4, y:4, z:4});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);
            });

            // yellow torus
            socket.on('yellow', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "yellow");
                fakeTarget.setAttribute('material', {color: "yellow"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:3, y:3, z:3});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);
            });

            // green torus
            socket.on('green', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "green");
                fakeTarget.setAttribute('material', {color: "green"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:2, y:2, z:2});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);
            });

            // blue torus
            socket.on('blue', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "blue");
                fakeTarget.setAttribute('material', {color: "blue"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:1, y:1, z:1});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);
            });

            //purple torus
            socket.on('purple', function(data) {
                let colorStr = 'rbg(' + data.r + ','+data.g + ', '+ data.b + ')';
                console.log('color change event: ' + colorStr);
                
                let fakeTarget = document.createElement('a-torus');
                fakeTarget.setAttribute('id', "purple");
                fakeTarget.setAttribute('material', {color: "purple"});
                fakeTarget.setAttribute('position', {x:0, y:0, z:-12});
                fakeTarget.setAttribute('radius', {radius:2});
                fakeTarget.setAttribute('scale', {x:0.5, y:0.5, z:0.5});
                fakeTarget.setAttribute('delete', {});
                let scene = document.querySelector('a-scene');
                scene.appendChild(fakeTarget);
            });



            //deleting when clicking to create competition 
            AFRAME.registerComponent('deletecomponent', {
            schema: {},
            init : function() {
                const Context_AF = this;
                
                Context_AF.el.addEventListener('click', function(event) {
                    console.log("click");
                    //object clicked - lets create a cow!
                    Context_AF.deleteMyself();
                
                });
            },
            deleteMyself : function() {
                const Context_AF = this;
                Context_AF.el.parentNode.removeChild(Context_AF.el); 
                socket.emit('removeTorus');
                
            }
           
            });
            AFRAME.registerComponent('delete', {
            schema: {},
            init : function() {
                const Context_AF = this;
                
                Context_AF.el.addEventListener('click', function(event) {
                    console.log("click");
                    //object clicked - lets create a cow!
                    Context_AF.delete();
                
                });
            },
            delete : function() {
                const Context_AF = this;
                Context_AF.el.parentNode.removeChild(Context_AF.el); 
                socket.emit('remove');
            }
           
            });
            
        </script>
    </body>
</html>